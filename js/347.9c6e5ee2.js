"use strict";(self["webpackChunklove"]=self["webpackChunklove"]||[]).push([[347],{347:function(t,a,e){e.r(a),e.d(a,{default:function(){return u}});var s=function(){var t=this,a=t._self._c;return a("div",{staticClass:"container"},[a("hr"),a("span",{staticClass:"tip"},[t._v("各项目将在筹集满积分落地由平台实施")]),4!=t.activeName?a("div",{staticClass:"header"},[a("span",[t._v("公益类型：")]),a("el-select",{attrs:{clearable:"",placeholder:"请选择需要查看的公益类型"},model:{value:t.publicData.catagoryId,callback:function(a){t.$set(t.publicData,"catagoryId",a)},expression:"publicData.catagoryId"}},t._l(t.itemCatagory,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),a("el-input",{staticClass:"search",attrs:{placeholder:"请输入搜索内容"},model:{value:t.publicData.condition,callback:function(a){t.$set(t.publicData,"condition",a)},expression:"publicData.condition"}},[a("el-button",{staticClass:"btnSearch",attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.searchPublic},slot:"append"},[t._v("搜索")])],1)],1):t._e(),a("el-tabs",{attrs:{"tab-position":"top"},model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"平台公益",name:"1"}},[a("div",{staticClass:"welfare"},t._l(t.publicSelectData.records,(function(e){return a("router-link",{key:e.id,staticClass:"welfareCard",attrs:{to:`/publicItem?id=${e.id}`}},[a("span",{staticClass:"state"},[t._v(t._s(t._f("status")(e.status)))]),a("span",{staticClass:"hidden"},[a("img",{attrs:{src:e.imgUrl,alt:""}})]),a("span",{staticClass:"title"},[t._v(t._s(e.name))]),a("span",{staticClass:"progress"},[a("el-progress",{attrs:{percentage:e.rate,format:t.format,color:t.colors}}),a("i",[t._v("项目进度：")]),a("span",{staticClass:"throw"},[t._v("积分捐献")])],1),a("span",{staticClass:"source"},[t._v("投放方："),a("i",[t._v(t._s(e.sponsor))])])])})),1)]),a("el-tab-pane",{attrs:{label:"社会团体公益",name:"2"}},[a("div",{staticClass:"welfare"},[a("router-link",{staticClass:"welfareCard",attrs:{to:"/publicItem"}},[a("span",{staticClass:"state"},[t._v("筹备中")]),a("span",{staticClass:"hidden"},[a("img",{attrs:{src:e(3278),alt:""}})]),a("span",{staticClass:"title"},[t._v("阿福童财经素养教育")]),a("span",{staticClass:"progress"},[a("el-progress",{attrs:{percentage:20,format:t.format,color:"#ee7767"}}),a("i",[t._v("项目进度：")]),a("button",{staticClass:"throw"},[t._v("积分投放")])],1),a("span",{staticClass:"source"},[t._v("投放方："),a("i",[t._v("茂南区飞翔志愿服务队")])])])],1)]),a("el-tab-pane",{attrs:{label:"参加过的公益",name:"3"}},[a("div",{staticClass:"welfare"},t._l(t.publicSelectData.records,(function(e){return a("router-link",{key:e.id,staticClass:"welfareCard",attrs:{to:`/publicItem?id=${e.id}`}},[a("span",{staticClass:"state"},[t._v(t._s(t._f("status")(e.status)))]),a("span",{staticClass:"hidden"},[a("img",{attrs:{src:e.imgUrl,alt:""}})]),a("span",{staticClass:"title"},[t._v(t._s(e.name))]),a("span",{staticClass:"progress"},[a("el-progress",{attrs:{percentage:e.rate,format:t.format,color:t.colors}}),a("i",[t._v("项目进度：")]),a("span",{staticClass:"throw"},[t._v("积分捐献")])],1),a("span",{staticClass:"source"},[t._v("投放方："),a("i",[t._v(t._s(e.sponsor))])])])})),1)]),a("el-tab-pane",{attrs:{label:"积分使用记录",name:"4"}},[a("el-table",{staticStyle:{width:"80%",margin:"0px 0 20px 10px","letter-spacing":"2px"},attrs:{data:t.useIntegration,"summary-method":t.getSummaries,"show-summary":""}},[a("el-table-column",{attrs:{type:"index",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"useTime",label:"日期"}}),a("el-table-column",{attrs:{prop:"itemName",label:"项目名"}}),a("el-table-column",{attrs:{prop:"useIntegration",label:"用户使用的积分"}})],1)],1)],1),4!=t.activeName?a("Pagination",{attrs:{pageNo:t.publicData.currentPage,pageSize:t.publicData.size,total:t.total,continues:5},on:{getPageNo:t.getPageNo}}):t._e()],1)},i=[],r=(e(7658),e(3822)),l={name:"PublicWelfare",data(){return{activeName:"1",colors:[{color:"#ff4949",percentage:25},{color:"#e6a23c",percentage:50},{color:"#20a0ff",percentage:75},{color:"#13ce66",percentage:100}],searchOrClick:!1,publicData:{catagoryId:"",currentPage:1,condition:"",size:8}}},mounted(){this.getPulicClassDate(),this.$store.dispatch("getItemCatagory"),null!=this.memberData&&this.$store.dispatch("getUseIntegration",this.memberData.userId)},methods:{format(t){return 100===t?"已集满":`${t}%`},getSummaries(t){const{columns:a,data:e}=t,s=[];return a.forEach(((t,a)=>{if(0===a)return void(s[a]="积分捐献总数");const i=e.map((a=>Number(a[t.property])));i.every((t=>isNaN(t)))?s[a]="N/A":(s[a]=i.reduce(((t,a)=>{const e=Number(a);return isNaN(e)?t:t+a}),0),s[a]+=" 积分")})),s},getPulicClassDate(){let t=this.publicData;for(let a in t)""===t[a]&&delete t[a];if("1"==this.activeName)void 0==this.publicData.catagoryId?this.$store.dispatch("getAllItem",t):void 0!=this.publicData.catagoryId&&this.$store.dispatch("getItemClass",t);else if("3"==this.activeName)if(void 0==this.publicData.catagoryId){let t={currentPage:this.publicData.currentPage,size:this.publicData.size,memberId:this.memberData.userId};this.$store.dispatch("getJoinPubItem",t)}else void 0!=this.publicData.catagoryId&&this.$store.dispatch("getItemClass",t)},searchPublic(){if(void 0!=this.publicData.catagoryId)if(void 0!=this.publicData.condition){let t={catagoryId:this.publicData.catagoryId,condition:this.publicData.condition,currentPage:this.publicData.currentPage,size:this.publicData.size};this.$store.dispatch("getItemSearch",t),this.searchOrClick=!0}else this.$message({message:"搜索框不能为空，请您输入需要搜索的内容!",type:"warning"});else this.$message({message:"为了精准搜索，您需要先选择公益类型！",type:"warning"})},getPageNo(t){this.publicData.currentPage=t,this.getPulicClassDate()}},computed:{...(0,r.rn)({publicSelectData:t=>t.publicWelfare.publicSelectData||[],itemCatagory:t=>t.publicWelfare.itemCatagory||[],memberData:t=>t.user.member,useIntegrate:t=>t.publicWelfare.useIntegration||[]}),total(){return this.publicSelectData.total},useIntegration(){for(let t=0;t<this.useIntegrate.length;t++)this.useIntegrate[t].useTime=this.useIntegrate[t].useTime.split("T")[0];return this.useIntegrate}},filters:{status(t){return 0==t?"筹备中":1==t?"运行中":2==t?"已结项":void 0}},watch:{activeName(t,a){this.publicData.condition="",this.publicData.catagoryId="",this.getPulicClassDate(),Object.assign(this.publicData,{catagoryId:"",currentPage:1,condition:"",size:8}),"3"==t||"4"==t?this.$router.push({query:{islogin:1}}):this.$router.push({query:{}})},"publicData.catagoryId":{handler(){this.publicData.condition="",this.getPulicClassDate()}},"publicData.condition":{handler(t){""==t&&this.searchOrClick&&(this.getPulicClassDate(),this.searchOrClick=!1)}}}},c=l,o=e(1001),n=(0,o.Z)(c,s,i,!1,null,"0e9bf98c",null),u=n.exports},3278:function(t,a,e){t.exports=e.p+"img/yushe.11478335.png"}}]);